name: Collections_new
on: push
jobs:
  Details_Config:
    runs-on: windows-latest
    steps:
      - name: code checkout
        uses: actions/checkout@v3
        with:
          fetch-depth: 2
      - name: Task1- Read the config file and display the contents of it
        run: |
          $myJson = Get-Content ".github/devops.config" -Raw | ConvertFrom-Json 
          echo $myJson
      - name: Task2- Assign the values into variables from config file
        run: |
          $myName = $myJson.name
          $myEmpId = $myJson.employee_id
          $Myversion = $myJson.version
          $myNam, $myEmpId, $Myversion
      - name: Task3- If any values missed in json, it will throw an error message
        run: |
          if ([string]::IsNullOrEmpty($myName) -or [string]::IsNullOrEmpty($myEmpId) -or [string]::IsNullOrEmpty($Myversion)) 
          {echo "value is null"}
  GithubAction_details:
    runs-on: windows-latest
    steps:
      - name: Tas4- display workflow-path, repo-name, author, build-no, branch name
        run: |
          echo "author:" '${{ toJSON(github.repository_owner) }}'
          echo "workflow-path:" '${{ toJSON(github.ref) }}'
          echo "branch name:" '${{ toJSON(github.ref_name	) }}'
          echo "build-no:" '${{ toJSON(github.run_number) }}'
          echo "repo name:" '${{ toJSON(github.repository) }}'
  Using_Secrets:
    runs-on: windows-latest
    steps:
      - name: Task5- create secrets and use those secrets in your job
        env:
          PASSWORD_PS: ${{secrets.PASSWORD}}
        run: echo $PASSWORD
  Gbuild:
    name: Create Release
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Create Release
        id: create_release
        uses: actions/create-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # This token is provided by Actions, you do not need to create your own token
        with:
          tag_name: ${{ github.ref }}
          release_name: Release ${{ github.ref }}
          body: |
            Changes in this Release
            - First Change
            - Second Change
          draft: false
          prerelease: false

